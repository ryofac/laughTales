[gd_scene load_steps=28 format=3 uid="uid://57x7iq35c221"]

[ext_resource type="PackedScene" uid="uid://dm6itx56ensml" path="res://Scenes/enemy.tscn" id="1_xv084"]
[ext_resource type="Texture2D" uid="uid://c153x06h30dk8" path="res://Assets/Image/enemy/smallDemon/hit.png" id="2_15ijw"]
[ext_resource type="Texture2D" uid="uid://h3bsyhfrxior" path="res://Assets/Image/enemy/smallDemon/idle.png" id="3_4fx3x"]
[ext_resource type="Texture2D" uid="uid://fv26nawi5mto" path="res://Assets/Image/enemy/smallDemon/run.png" id="4_0pgl7"]
[ext_resource type="Script" path="res://Scripts/state/StateMachine.gd" id="5_uvjuy"]
[ext_resource type="Script" path="res://Scripts/enemy/smallDemon/idle.gd" id="6_q1ilu"]
[ext_resource type="Script" path="res://Scripts/enemy/throwEnemy/attackingState.gd" id="8_ho6ys"]
[ext_resource type="Script" path="res://Scripts/enemy/throwEnemy/enemyWander.gd" id="8_oo4fp"]
[ext_resource type="Script" path="res://Scripts/enemy/throwEnemy/enemyAttacked.gd" id="9_n2apv"]
[ext_resource type="Script" path="res://Scripts/enemy/throwEnemy/fleeState.gd" id="10_22utk"]
[ext_resource type="Texture2D" uid="uid://cjq7lsolpfbr7" path="res://Assets/Image/gui/UI-pack-kenney/PNG/barBack_horizontalMid.png" id="11_ytny1"]
[ext_resource type="Texture2D" uid="uid://chx36yghti2g" path="res://Assets/Image/gui/UI-pack-kenney/PNG/edge.png" id="12_h3omr"]
[ext_resource type="Texture2D" uid="uid://rurricfbmdj5" path="res://Assets/Image/gui/UI-pack-kenney/PNG/barGreen_horizontalMid.png" id="13_nfml0"]
[ext_resource type="AudioStream" uid="uid://ed7d8suij0s3" path="res://Assets/Audio/Enemy/enemy_attack.mp3" id="14_5oega"]
[ext_resource type="AudioStream" uid="uid://d15k1bpmmh4jw" path="res://Assets/Audio/Enemy/enemiesDying.mp3" id="15_783xm"]

[sub_resource type="AtlasTexture" id="AtlasTexture_yuj58"]
atlas = ExtResource("2_15ijw")
region = Rect2(32, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_8dqls"]
atlas = ExtResource("2_15ijw")
region = Rect2(48, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_y21bn"]
atlas = ExtResource("3_4fx3x")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_sy8ll"]
atlas = ExtResource("3_4fx3x")
region = Rect2(16, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_hovnm"]
atlas = ExtResource("3_4fx3x")
region = Rect2(32, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_sv1yt"]
atlas = ExtResource("3_4fx3x")
region = Rect2(48, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_h5vbw"]
atlas = ExtResource("4_0pgl7")
region = Rect2(0, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_sjjg0"]
atlas = ExtResource("4_0pgl7")
region = Rect2(16, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_4jjw0"]
atlas = ExtResource("4_0pgl7")
region = Rect2(32, 0, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_cuepi"]
atlas = ExtResource("4_0pgl7")
region = Rect2(48, 0, 16, 16)

[sub_resource type="SpriteFrames" id="SpriteFrames_v6ccg"]
animations = [{
"frames": [],
"loop": true,
"name": &"attack",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_yuj58")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8dqls")
}],
"loop": false,
"name": &"hit",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_y21bn")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_sy8ll")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_hovnm")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_sv1yt")
}],
"loop": true,
"name": &"idle",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_h5vbw")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_sjjg0")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_4jjw0")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_cuepi")
}],
"loop": true,
"name": &"run",
"speed": 5.0
}]

[sub_resource type="CircleShape2D" id="CircleShape2D_8bwll"]
radius = 42.0119

[node name="Enemy" node_paths=PackedStringArray("navAgent") instance=ExtResource("1_xv084")]
motion_mode = 1
wall_min_slide_angle = 0.0
navAgent = NodePath("Navigation/NavigationAgent2D")
speed = 30.0

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="." index="0"]
texture_filter = 1
sprite_frames = SubResource("SpriteFrames_v6ccg")
animation = &"run"

[node name="StateMachine" parent="." index="2" node_paths=PackedStringArray("initialState")]
script = ExtResource("5_uvjuy")
initialState = NodePath("idle")

[node name="idle" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("6_q1ilu")
enemy = NodePath("../..")

[node name="attacking" parent="StateMachine" index="1" node_paths=PackedStringArray("fleeArea", "enemy")]
script = ExtResource("8_ho6ys")
timeBetweenThrows = 1.0
timeDuringAttack = 3.0
fleeArea = NodePath("../../FleeArea")
enemy = NodePath("../..")

[node name="wandering" parent="StateMachine" index="2" node_paths=PackedStringArray("enemy")]
script = ExtResource("8_oo4fp")
enemy = NodePath("../..")

[node name="attacked" parent="StateMachine" index="3" node_paths=PackedStringArray("enemy")]
script = ExtResource("9_n2apv")
enemy = NodePath("../..")

[node name="flee" type="Node" parent="StateMachine" index="4" node_paths=PackedStringArray("enemy")]
script = ExtResource("10_22utk")
flee = true
enemy = NodePath("../..")

[node name="TextureProgressBar" type="TextureProgressBar" parent="." index="4"]
texture_filter = 1
anchors_preset = 13
anchor_left = 0.5
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -8.0
offset_top = -11.0
offset_right = 8.0
offset_bottom = -9.0
grow_horizontal = 2
grow_vertical = 2
value = 89.0
nine_patch_stretch = true
texture_under = ExtResource("11_ytny1")
texture_over = ExtResource("12_h3omr")
texture_progress = ExtResource("13_nfml0")

[node name="RecalcPathTimer" parent="Navigation" index="1"]
autostart = true

[node name="CoolDownAttackTimer" type="Timer" parent="." index="7"]
wait_time = 0.5

[node name="Death" parent="Audio" index="0"]
stream = ExtResource("15_783xm")

[node name="TakingDamage" type="AudioStreamPlayer2D" parent="Audio" index="1"]
stream = ExtResource("14_5oega")
volume_db = -10.0
pitch_scale = 4.0
panning_strength = 0.42

[node name="FleeArea" type="Area2D" parent="." index="9"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="FleeArea" index="0"]
shape = SubResource("CircleShape2D_8bwll")

[connection signal="timeout" from="Navigation/RecalcPathTimer" to="StateMachine/flee" method="_on_recalc_path_timer_timeout"]
[connection signal="timeout" from="CoolDownAttackTimer" to="StateMachine/attacking" method="_on_cool_down_attack_timer_timeout"]
[connection signal="body_entered" from="FleeArea" to="." method="_on_flee_area_body_entered"]
